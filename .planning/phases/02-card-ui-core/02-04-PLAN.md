---
phase: 02-card-ui-core
plan: 04
type: execute
wave: 2
depends_on:
  - 02-03
files_modified:
  - mobile/app/(tabs)/fortune.tsx
  - mobile/app/(tabs)/index.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "既存のタブ画面からスワイプ可能なカードUIにアクセスできる"
    - "ユーザーはナビゲーションを迷うことなくカード一覧に到達できる"
  artifacts:
    - path: "mobile/app/(tabs)/fortune.tsx"
      provides: "占いタブ画面（スワイプカードUIへのエントリーポイント）"
      min_lines: 50
  key_links:
    - from: "mobile/app/(tabs)/fortune.tsx"
      to: "mobile/app/zodiac-select.tsx"
      via: "router.push('/zodiac-select')"
      pattern: "router.push.*zodiac-select"
    - from: "mobile/app/(tabs)/index.tsx"
      to: "mobile/app/zodiac-select.tsx"
      via: "router.push('/zodiac-select')"
      pattern: "zodiac-select"
---

# Plan 02-04: 既存画面からのナビゲーション統合

## Objective

既存のアプリ画面（占いタブ、診断タブ）から新しく作成したスワイプカードUI（zodiac-select）へのナビゲーションを追加する。これにより、ユーザーは自然な操作フローでカードUIにアクセスできるようになる。

## Context

### ギャップ分析
VERIFICATION.mdより:
- **問題**: SwipeableStackコンポーネントがORPHANED（どの画面からも呼ばれていない）
- **02-03で解決**: zodiac-select.tsx画面を作成し、SwipeableStackを統合
- **02-04で解決**: 既存画面からzodiac-selectへのナビゲーションを追加

### 既存の画面構造
- `mobile/app/(tabs)/fortune.tsx` - 占いタブ（現在は空またはプレースホルダー）
- `mobile/app/(tabs)/index.tsx` - 診断タブ（診断スタートボタンあり）
- `mobile/app/(tabs)/_layout.tsx` - タブレイアウト定義

### ユーザーフロー
1. 占いタブをタップ → スワイプカード選択画面へ
2. 診断タブの「診断スタート」→ スワイプカード選択画面へ（オプション）

## Success Criteria (must_haves)

1. [ ] 占いタブをタップすると、スワイプカード選択画面が表示される
2. [ ] カードスワイプで干支を選択できる
3. [ ] 戻るボタンで占いタブに戻れる
4. [ ] ナビゲーションがスムーズである（スタックの問題なし）

## Tasks

### Task 1: 占いタブ画面の実装

占いタブ（fortune.tsx）をスワイプカードUIへのエントリーポイントとして実装する。

**ファイル:** `mobile/app/(tabs)/fortune.tsx`

現在の状態を確認し、以下の内容に書き換える:

```typescript
import { View, Text, TouchableOpacity } from 'react-native';
import { useRouter } from 'expo-router';
import { Sparkles, ArrowRight } from 'lucide-react-native';

export default function FortuneTab() {
    const router = useRouter();

    const handleStart = () => {
        router.push('/zodiac-select');
    };

    return (
        <View className="flex-1 bg-[#FFF9E6] items-center justify-center p-6">
            {/* Hero Section */}
            <View className="items-center mb-12">
                <View className="bg-[#333] px-6 py-2 mb-4 rounded-full">
                    <Text className="text-white font-black text-lg">ZODIAC SWIPE</Text>
                </View>
                <Text className="font-black text-3xl text-[#333] mb-2">干支占い</Text>
                <Text className="text-gray-600 text-center">
                    スワイプしてあなたの運勢をチェック
                </Text>
            </View>

            {/* Illustration/Preview */}
            <View className="w-64 h-80 bg-white rounded-3xl mb-8 border-4 border-[#333] shadow-lg items-center justify-center">
                <Text className="text-8xl">♈</Text>
                <Text className="text-xl font-bold text-[#333] mt-4">Aries</Text>
                <View className="flex-row gap-2 mt-2">
                    <View className="px-2 py-1 bg-violet-100 rounded-full">
                        <Text className="text-xs text-violet-700">Courageous</Text>
                    </View>
                </View>
            </View>

            {/* Instructions */}
            <View className="bg-white p-4 rounded-2xl border-3 border-[#333] mb-8 w-full">
                <Text className="text-center font-bold text-[#333] mb-2">使い方</Text>
                <View className="flex-row justify-between">
                    <View className="items-center">
                        <View className="w-12 h-12 bg-rose-400 rounded-full items-center justify-center mb-1">
                            <Text className="text-white font-bold">←</Text>
                        </View>
                        <Text className="text-xs text-gray-600">スキップ</Text>
                    </View>
                    <View className="items-center">
                        <View className="w-12 h-12 bg-emerald-400 rounded-full items-center justify-center mb-1">
                            <Text className="text-white font-bold">→</Text>
                        </View>
                        <Text className="text-xs text-gray-600">選択</Text>
                    </View>
                </View>
            </View>

            {/* Start Button */}
            <TouchableOpacity
                onPress={handleStart}
                className="flex-row items-center gap-2 bg-violet-600 px-8 py-4 rounded-2xl border-4 border-[#333] shadow-lg"
            >
                <Sparkles size={24} color="#fff" />
                <Text className="text-white font-black text-lg">スワイプを始める</Text>
                <ArrowRight size={24} color="#fff" />
            </TouchableOpacity>
        </View>
    );
}
```

**検証:**
- [ ] ファイルが更新されている
- [ ] TypeScriptエラーがない
- [ ] router.push('/zodiac-select')が含まれている

### Task 2: （オプション）診断タブからのリンク追加

診断タブからもスワイプカードUIへのアクセスを追加する。

**ファイル:** `mobile/app/(tabs)/index.tsx`

既存の「診断スタート」ボタンの下に追加:

```typescript
{/* 既存の診断スタートボタンの後に追加 */}
<View className="items-center mt-6">
    <TouchableOpacity onPress={() => router.push('/zodiac-select')}>
        <Text className="text-violet-600 font-bold underline">
            まずは干支を選んでみる →
        </Text>
    </TouchableOpacity>
</View>
```

**検証:**
- [ ] リンクが追加されている
- [ ] タップでzodiac-selectに遷移する

## Verification

実機またはエミュレータで以下を検証:

1. [ ] アプリを起動し、占いタブをタップする
2. [ ] 「スワイプを始める」ボタンが表示される
3. [ ] ボタンをタップすると、スワイプカード選択画面が表示される
4. [ ] スワイプ操作でカードを閲覧できる
5. [ ] 戻るボタンまたはスワイプバックで占いタブに戻れる
6. [ ] 診断タブからのリンクでもアクセスできる（オプション）

## Complete User Flow

1. [ ] 占いタブ → 「スワイプを始める」→ カード選択画面
2. [ ] 右スワイプ → `/fortune/{signId}` 詳細画面
3. [ ] 詳細画面から戻る → 再びカード選択画面（続きから）
4. [ ] すべてのカードを閲覧できる（無限ループ）

## Output

完了後、`.planning/phases/02-card-ui-core/02-04-SUMMARY.md` を作成する。
