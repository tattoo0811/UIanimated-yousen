---
phase: 01-overview-stats
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - src/data/characters.ts
  - src/components/features/CharactersList.tsx
  - src/app/dashboard/page.tsx
autonomous: true

must_haves:
  truths:
    - "ユーザーは主要登場人物5人の概要を閲覧できる"
    - "5人目のキャラクター（神田栞）がデータに追加されている"
    - "既存のキャラクタータブに5人目が表示されている"
    - "各キャラクターの基本情報（名前、干支、登場範囲、役割）が確認できる"
  artifacts:
    - path: "src/data/characters.ts"
      provides: "5人の主要キャラクターデータ"
      exports: ["CHARACTERS", "CharacterData", "getCharacterById"]
    - path: "src/components/features/CharactersList.tsx"
      provides: "キャラクター一覧表示コンポーネント"
      min_lines: 50
    - path: "src/app/dashboard/page.tsx"
      contains: "CharactersListコンポーネントの使用"
  key_links:
    - from: "src/components/features/CharactersList.tsx"
      to: "src/data/characters.ts"
      via: "import { CHARACTERS }"
      pattern: "import.*CHARACTERS"
    - from: "src/app/dashboard/page.tsx"
      to: "src/components/features/CharactersList.tsx"
      via: "CharactersTab内でのJSXレンダリング"
      pattern: "<CharactersList"
---

<objective>
主要登場人物5人のデータを拡張し、ダッシュボードのキャラクタータブに表示する。

Purpose: ユーザーが主要登場人物5人（巡、慧、美咲、さくら、栞）の概要を閲覧できるようにする
Output: src/data/characters.ts（拡張）、src/components/features/CharactersList.tsx（新規）、src/app/dashboard/page.tsx（変更）
</objective>

<execution_context>
@/Users/kitamuratatsuhiko/.claude/get-shit-done/workflows/execute-plan.md
@/Users/kitamuratatsuhiko/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md
@.planning/STATE.md
@/Users/kitamuratatsuhiko/UIanimated/src/app/dashboard/page.tsx
@/Users/kitamuratatsuhiko/UIanimated/src/data/characters.ts
@/Users/kitamuratatsuhiko/UIanimated/novel/dashboards/DASHBOARD.md

# 既存キャラクターデータ
characters.ts: 既に4キャラクター（巡、慧、美咲、さくら）のデータがある
</context>

<tasks>

<task type="auto">
  <name>Add 5th main character (神田栞) to characters data</name>
  <files>src/data/characters.ts</files>
  <action>
src/data/characters.tsに5人目の主要キャラクター（神田栞）を追加する。

1. 既存のCharacterDataインターフェースを確認：
   - 現在の4キャラクターと同じ構造を使用
   - id, name, nameReading, role, birthDate, gender, age, avatar, color, colorAccentが必要
   - meishiki, story, relationshipsも必要

2. 神田栞のデータを追加（正典 DASHBOARD.md の「主要登場人物」セクションから）：
```typescript
{
  id: 'C005',
  name: '神田 栞',
  nameReading: 'かんだ しおん',
  role: '巡の精神科医時代の同僚・友人',
  birthDate: '1988-06-15', // 推定（慧より1歳年下）
  gender: 'male',
  age: 38, // 2026年時点
  avatar: '/characters/shion.png',
  color: 'from-teal-500 to-emerald-600',
  colorAccent: '#14b8a6',
  meishiki: {
    yearPillar: { gan: '戊', shi: '午' }, // 推定
    monthPillar: { gan: '丁', shi: '巳' }, // 推定
    dayPillar: { gan: '甲', shi: '寅' }, // 推定
    daiun: 'reverse', // 推定
    ritsuun: 5, // 推定
    sanun: [
      { name: '天刃星', score: 5 },
      { name: '天南星', score: 8 },
      { name: '天印星', score: 4 },
    ],
    energy: 150, // 推定
  },
  story: {
    summary: '巡が精神科医時代の同僚。うつ状態にあった巡を理解し、支え続けた数少ない理解者。',
    keywords: ['理解者', '同僚', '友人'],
    arc: '同僚としての支え → 精神科医時代の記憶 → 第84話での再会',
  },
  relationships: [
    { targetId: 'C001', type: '同僚・友人', description: '精神科医時代の同僚。巡のうつ状態を理解していた。' },
  ],
}
```

3. データ追加の注意点：
   - avatarパスは '/characters/shion.png'（ファイルはまだ存在しなくてOK、プレースホルダーとして）
   - meishikiデータは正典に記載がないため推定値で作成
   - roleは「精神科医時代の同僚・友人」と正典通り
   - 登場範囲は「第84, 88, 95話」と正典通り

4. CHARACTERS配列に追加後、getCharacterByNameとgetCharacterById関数は変更なし（既存のまま動作）

重要: 正典には命式データがないため、meishikiは推定値で作成すること。コメントで「推定値」と明記すること。
  </action>
  <verify>
1. CHARACTERS配列の長さが5になっている: `CHARACTERS.length === 5`
2. 5人目のidが'C005'で、nameが'神田 栞'である
3. TypeScript型チェックが通る: npx tsc --noEmit
4. getCharacterById('C005')で正しく取得できる
  </verify>
  <done>
src/data/characters.tsに神田栞が追加され、CHARACTERS配列が5キャラクターを含んでいる
  </done>
</task>

<task type="auto">
  <name>Create CharactersList component with 5-character grid</name>
  <files>src/components/features/CharactersList.tsx</files>
  <action>
新規コンポーネント src/components/features/CharactersList.tsx を作成する。

1. 既存のCharacterCardコンポーネントを再利用：
```typescript
interface CharactersListProps {
  viewMode: 'simple' | 'detailed';
}

export function CharactersList({ viewMode }: CharactersListProps) {
  return (
    <div className="space-y-4">
      <div className="flex items-center justify-between mb-2">
        <h2 className="text-lg font-semibold text-white">主要キャラクター</h2>
        <p className="text-xs text-slate-500">{CHARACTERS.length}名</p>
      </div>
      <div className="grid gap-4 lg:grid-cols-2">
        {CHARACTERS.map((char, i) => (
          <CharacterCard key={char.id} character={char} viewMode={viewMode} index={i} />
        ))}
      </div>
    </div>
  );
}
```

2. 重要: 既存のdashboard/page.tsxのCharactersTab関数（226-239行目）とほぼ同じ構造にする：
   - 既存のCharacterCardコンポーネントをそのまま使用
   - lg:grid-cols-2のレイアウトを維持
   - space-y-4の間隔を維持

3. 新規コンポーネントを作成する理由：
   - キャラクター一覧を独立コンポーネントとして切り出す
   - 今後の拡張（フィルタリング、ソート等）を容易にする
   - dashboard/page.tsxの肥大化を防ぐ

4. 既存のCharacterCardとの整合性：
   - viewMode propをそのまま渡す
   - index propを渡す（アニメーション遅延用）
   - CharacterCardの内部実装は一切変更なし

重要: 既存のCharactersTab機能を完全に再現すること。見た目や動作は全く同じにすること。
  </action>
  <verify>
1. コンポーネントが正常にインポートできる
2. 5人のキャラクターカードがグリッドレイアウトで表示される
3. 各キャラクターの情報（名前、役割、命式等）がCharacterCardを通じて正しく表示される
4. レスポンシブに動作（モバイルで1列、デスクトップで2列）
  </verify>
  <done>
CharactersListコンポーネントが作成され、5人の主要キャラクター（巡、慧、美咲、さくら、栞）を表示している
  </done>
</task>

<task type="auto">
  <name>Integrate CharactersList into dashboard characters tab</name>
  <files>src/app/dashboard/page.tsx</files>
  <action>
src/app/dashboard/page.tsxを更新し、CharactersListコンポーネントを統合する。

1. インポートを追加：
```typescript
import { CharactersList } from '@/components/features/CharactersList';
```

2. CharactersTab関数を置き換え（既存の226-239行目）：
```tsx
function CharactersTab({ viewMode }: { viewMode: ViewMode }) {
  return <CharactersList viewMode={viewMode} />;
}
```

3. 既存のCharactersTabと完全に同じ機能を維持：
   - ヘッダー部分（「主要キャラクター」見出しとキャラクター数）
   - グリッドレイアウト（lg:grid-cols-2）
   - 各キャラクターのCharacterCard表示

4. CharactersListコンポーネント内部でこれらを実装しているため：
   - CharactersTabは単に<CharactersList viewMode={viewMode} />を返すだけ
   - シンプルで明快な構造

5. 既存のCharacterCardコンポーネントのインポートは維持：
   - CharactersListから使用されるため必要
   - import { CharacterCard } from '@/components/features/CharacterCard'は残す

重要: 変更前後でキャラクタータブの機能と見た目が完全に同じであることを確認すること。
  </action>
  <verify>
1. キャラクタータブを開き、5人のキャラクターが表示されることを確認
2. 既存の4キャラクターに加え、神田栞が5人目として表示されていることを確認
3. レスポンシブデザインが維持されていることを確認（モバイルで1列、デスクトップで2列）
4. 各キャラクターカードの詳細情報（命式、ストーリー等）が正しく表示されていることを確認
5. TypeScriptエラーがないこと: npx tsc --noEmit
  </verify>
  <done>
キャラクタータブにCharactersListコンポーネントが統合され、ユーザーは主要登場人物5人（巡、慧、美咲、さくら、栞）の概要を閲覧できる
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
主要キャラクター5人のデータ拡張と表示機能が実装されました：
- 神田栞のキャラクターデータがcharacters.tsに追加されました
- CharactersListコンポーネントが作成されました
- キャラクタータブが5人を表示するように更新されました
  </what-built>
  <how-to-verify>
1. ダッシュボードページを開きます (http://localhost:3000/dashboard)
2. 「キャラクター」タブをクリックします
3. 5人のキャラクターが表示されていることを確認します：
   - 九条 巡（主人公）
   - 九条 さくら（祖母）
   - 藤堂 慧（敵対者）
   - 高橋 美咲（ヒロイン）
   - 神田 栞（同僚・友人）★新規
4. 各キャラクターカードをクリックし、詳細情報が表示されることを確認します
5. レスポンシブを確認：モバイルサイズで1列、デスクトップで2列になっている
6. 詳細モードに切替え、追加情報が表示されることを確認します
  </how-to-verify>
  <resume-signal>
キャラクター5人が正しく表示されていることを確認しました。「approved」と入力してください。問題がある場合は詳細を教えてください。
  </resume-signal>
</task>

</tasks>

<verification>
After completing all tasks (before checkpoint), verify the following:

1. **Data Accuracy**: src/data/characters.tsに5人目のキャラクターが正典通り追加されている
   - 名前: 神田 栞
   - 役割: 精神科医時代の同僚・友人
   - 登場範囲: 第84, 88, 95話

2. **Component Functionality**: CharactersListコンポーネントが5人のキャラクターを表示
   - 既存のCharacterCardを正しく使用している
   - viewMode propで詳細/シンプル切替ができる

3. **Integration**: キャラクタータブに統合され、既存の機能を維持している
   - 4人→5人への変更以外は見た目が同じ
   - レスポンシブデザインが動作している

4. **Type Safety**: TypeScript型エラーなし

5. **Avatar Handling**: 神田栞のavatarファイルが存在しなくてもエラーにならない（altテキストまたはプレースホルダー表示）
</verification>

<success_criteria>
1. ユーザーは主要登場人物5人の概要を閲覧できる（巡、慧、美咲、さくら、栞）
2. 5人目のキャラクター（神田栞）がデータに追加され、表示されている
3. 各キャラクターの基本情報（名前、干支、登場範囲、役割）が確認できる
4. 既存のキャラクタータブのデザインと機能が維持されている
5. レスポンシブデザインでモバイルとデスクトップ両対応している
</success_criteria>

<output>
After checkpoint approval, create `.planning/phases/01-overview-stats/01-03-SUMMARY.md` with:
- 神田栞のデータ追加詳細（推定命式値の理由）
- CharactersListコンポーネントの構造
- 既存CharacterCardとの統合方法
- User verification results
- Phase 1 completion status
</output>
