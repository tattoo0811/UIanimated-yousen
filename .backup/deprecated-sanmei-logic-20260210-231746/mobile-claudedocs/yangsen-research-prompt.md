# 陽占計算における蔵干の正しいデータ - リサーチプロンプト

## 目的
算命学の陽占（人体図）計算で使用する、各地支の蔵干データを正確に特定する。

## 現在判明している問題

### 矛盾する計算結果
同じ支（亥）でも、位置（年支・月支・日支）によって使う蔵干が異なる：

**ケース1: 1983-08-11 12:00**
- 四柱: 癸亥年 庚申月 辛未日 甲午時
- 日干: 辛(7)
- **年支 亥(11)の蔵干を「甲(0)」として計算**
  - 左手の計算: 辛 → 甲 = 司禄星 ✓（正解）

**ケース2: 1984-12-02 12:00**
- 四柱: 甲子年 乙亥月 庚午日 壬午時
- 日干: 庚(6)
- **月支 亥(11)の蔵干を「壬(8)」として計算**
  - 胸の計算: 庚 → 壬 = 鳳閣星 ✓（正解）

### 現在のデータ（間違っている）
```javascript
const YANGSEN_HIDDEN_STEMS = [
  '癸', // 子(0)
  '辛', // 丑(1)
  '丙', // 寅(2)
  '乙', // 卯(3)
  '乙', // 辰(4)
  '庚', // 巳(5)
  '丁', // 午(6)
  '丁', // 未(7)
  '戊', // 申(8)
  '辛', // 酉(9)
  '丁', // 戌(10)
  '?' // 亥(11) ← 位置によって異なる！
];
```

## リサーチすべき情報

### 1. 各地支の蔵干（本気・中気・余気）

算命学では、各地支に複数の蔵干があります：

| 地支 | 本気 | 中気 | 余気 |
|-----|------|------|------|
| 子 | ? | ? | ? |
| 丑 | ? | ? | ? |
| 寅 | ? | ? | ? |
| 卯 | ? | ? | ? |
| 辰 | ? | ? | ? |
| 巳 | ? | ? | ? |
| 午 | ? | ? | ? |
| 未 | ? | ? | ? |
| 申 | ? | ? | ? |
| 酉 | ? | ? | ? |
| 戌 | ? | ? | ? |
| 亥 | ? | ? | ? |

### 2. 陽占計算での蔵干選択ルール

以下のそれぞれで、どの蔵干（本気・中気・余気）を使うか：

**人体図の位置と対応する四柱:**
- **左手**: 年支の蔵干 → どれを使う？
- **胸**: 月支の蔵干 → どれを使う？
- **右手**: 日支の蔵干 → どれを使う？

### 3. 検証ポイント

以下の条件を満たすデータを見つける：

```
【1983-08-11の検証】
日干: 辛(7)
年支: 亥(11) → 蔵干 X
計算: getTenGreatStar(7, X) = 司禄星

【1984-12-02の検証】
日干: 庚(6)
月支: 亥(11) → 蔵干 Y
計算: getTenGreatStar(6, Y) = 鳳閣星
```

この場合、亥の蔵干は：
- 年支で使う: X = 甲(0)
- 月支で使う: Y = 壬(8)

## 推奨検索キーワード

### 日本語
- 「算命学 陽占 蔵干 一覧」
- 「算命学 地支 蔵干 本気 中気 余気」
- 「算命学 人体図 蔵干 使い分け」
- 「算命学 亥 蔵干 年支 月支」
- 「算命学 十大主星 計算 蔵干」

### 英語
- "Sanmei astrology hidden stems table"
- "Chinese astrology earthly branches hidden heavenly stems"
- "Bazi hidden stems calculation"
- "Four Pillars hidden stems year month day"

## 確認すべき情報源

1. **算命学の公式教材・書籍**
   - 高尾義政氏の著書
   - 算命学の正式なテキスト

2. **信頼できるウェブサイト**
   - 算命学の専門サイト
   - 四柱推命・算命学の計算ツールのソースコード

3. **既存のPC版コード**
   - `/Users/kitamuratatsuhiko/UIanimated/yinyang-app/src/utils/logic.ts`
   - コメントやドキュメント

4. **in-you/analytics-data**
   - `/Users/kitamuratatsuhiko/in-you/analytics-data`
   - 解析データやドキュメント

## 期待される成果物

以下の形式で正しいデータを提供：

```typescript
// 年支用の蔵干（左手の計算に使用）
const YANGSEN_YEAR_HIDDEN_STEMS = [
  '癸', // 子
  '辛', // 丑
  '丙', // 寅
  '乙', // 卯
  '乙', // 辰
  '庚', // 巳
  '丁', // 午
  '丁', // 未
  '戊', // 申
  '辛', // 酉
  '丁', // 戌
  '甲'  // 亥 ← 1983-08-11で検証済み
];

// 月支用の蔵干（胸の計算に使用）
const YANGSEN_MONTH_HIDDEN_STEMS = [
  '癸', // 子
  '辛', // 丑
  '丙', // 寅
  '乙', // 卯
  '乙', // 辰
  '庚', // 巳
  '丁', // 午
  '丁', // 未
  '戊', // 申
  '辛', // 酉
  '丁', // 戌
  '壬'  // 亥 ← 1984-12-02で検証済み
];

// 日支用の蔵干（右手の計算に使用）
const YANGSEN_DAY_HIDDEN_STEMS = [
  '癸', // 子
  '辛', // 丑
  '丙', // 寅
  '乙', // 卯
  '乙', // 辰
  '庚', // 巳
  '丁', // 午
  '丁', // 未
  '戊', // 申
  '辛', // 酉
  '丁', // 戌
  '?'   // 亥 ← 要調査
];
```

または、選択ルールの説明：
```
「年支・月支・日支で使う蔵干は、それぞれ本気・中気・余気の
いずれかを使用する。具体的には...」
```

## 重要な注意事項

1. **算命学と四柱推命の違いに注意**
   - 算命学独自の蔵干の使い方がある可能性

2. **陽占専用のルール**
   - 陰占（四柱推命の表示）とは異なる蔵干を使う

3. **既知の特殊ケース**
   - 申(8) = 戊 （YINSEN_HIDDEN_STEMSでは「己」）
   - 亥(11) = 年支「甲」/ 月支「壬」

4. **検証方法**
   - 見つけたデータで1983-08-11と1984-12-02の両方が正しく計算できることを確認

## リサーチ後の次のステップ

正しいデータが見つかったら：

1. YANGSEN_*_HIDDEN_STEMSの3つの配列を定義
2. calculateYangSen関数を修正して位置別に蔵干を使い分け
3. すべてのテストケースで検証
4. PC版のlogic.tsも同様に修正
